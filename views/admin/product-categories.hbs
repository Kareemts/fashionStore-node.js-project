<section>
  <div class="container" style="margin-top: -45px">
    <div class="row" style="width: 200px;  margin-left: 75%;  ">

      <a href="/admin/add-category" class="btn btn-secondary"> ADD NEW CATEGORIES</a>
    </div>
    <h3>CATEGORIES</h3>
    <table class="table mt-4" id="dataTabile">
      <thead>
        <tr>
          <th scope="col">NO</th>
          <th scope="col">CATEGORY NAME</th>
          <th scope="col">DELETE</th>
        </tr>
      </thead>
      <tbody>
        {{#each categories}}
        <tr>
          <td>{{inc @index}}</td>
          <td id={{this._id}}>{{this.categoryName}}</td>
          <td><a onclick="deletesp('{{this._id}}')"><i class="fi fi-rr-trash text-danger"></i></a></td>
        </tr>
        {{/each}}


      </tbody>
    </table>
  </div>
</section>

{{!-- </section>
{{#each categories}}
<div class="container px-1 mb-3 py-1 mx-auto row d-flex justify-content-center rounded-lg border border-dark ">
  <div class="col-lg-9 col-sm-11 ">
    <div class="card cardCategory pl-4 pl-md-5 pr-3">
      <div class="row">
        <div class="d-flex justify-content-end">
          <a onclick="deletesp('{{this._id}}')"><i class="fi fi-rr-trash text-danger"></i></a>
        </div>
        <div class="left-side col-md-5">
          <h5 class="pt-1 mb-0 text-dark"></h5>
          <h4 class=" text-dark"><strong>{{this.categoryName}}</strong></h4>
        </div>
        <div class="left-side col-md-5">
          <h6 class="pt-1 mb-0 text-dark "><strong>SUBCATEGORY</strong> <span>
              <a href="/admin/add-subCategory/{{this._id}}"><i
                  class="fi fi-rs-add text-dark d-flex justify-content-end  "></i></a>
            </span> </h6>
          {{#each this.subcategory}}
          <div>
            <div>
              <p  class="">{{this}}</p>
            </div>
            <div>
              <a href="/admin/delete-subCategory/{{this}}"
                onclick="return confirm('Are you Want to Delete {{this.NAME}} ?')"><i
                  class="fi fi-rr-trash text-dark d-flex justify-content-center"></i></a>
            </div>
          </div>
          {{/each}}
          <div>

          </div>
          <h6 class="mb-0 text-dark"><strong>{{this.subCategoryName}}</strong></h6>
        </div>
      </div>
    </div>
  </div>
</div>
{{/each}}
<section> --}}

  <script>
    function deletesp(categoryId) {
      alert('Category deleting')
      console.log(categoryId)
      let categoryName = document.getElementById(categoryId).innerHTML
      console.log(categoryName)
      $.ajax({
        url: '/admin/delete-category',
        data: {
          categoryName
        },
        method: 'post',

        success: (response) => {
          if (response.find) {
            alert('Product Exist in this category')
          } else {
            alert('Category deleted')
            location.reload();
          }
        }
      })
    }


    $(document).ready(function () {
      $('#example').DataTable();
    });

  </script>